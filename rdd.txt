    // 从TID二级索引中获取前一天所有记录，格式：RDD[(plateColor, plateNo, vehicleLogo, VPR_RowKey, passTime, vehicleType，isTaxi)]
    val tidIdxResultRDD: RDD[(Int, String, String, String, Long, String, Int)] = getVehiclePassIdxTIDRDD(sc, longStart,longEnd, hbaseZk)

    LOGGER.info("tidIdxResultRDD count={}", tidIdxResultRDD.count)
    // 获取时间标示
    val curMonTime = DateTimeUtils.format(longStart, "yyyy-MM")

    // 按车牌前缀过滤 RDD[(plateColor, plateNo, vehicleLogo, VPR_RowKey, passTime, vehicleType，isTaxi)]
    val filterByPrefixRDD: RDD[(Int, String, String, String, Long, String, Int)] = tidIdxResultRDD.filter(res => {
      res._1 > 0 && res._2 != null && res._2.startsWith(plateNoPrefix) && (!"车牌".equals(res._2))
    })

    // 获取车管库RDD，格式：RDD[(plateColor, plateNo, vehicleLogo, logoName, vehicletype)]
    val vehicleRegisterRDD: RDD[(Int, String, String, String, String)] = oracle2RddUtil.loadCgkRdd1(sc)

    LOGGER.info("vehicleRegisterRDD count={}", vehicleRegisterRDD.count)

    //获取未审核的已存在的假牌记录
    //返回类型[(platecolor,plateno,vehlogo,restype, isTaxi),rowkeys]

    val pgUtils2: PostgresUtils= PostgresUtils.getInstance()

    //RDD[(plate_color, false_plateno,rowkeys,restyp, isTaxi)]
    val falsePlateRDD: RDD[((Int, String,Int,Int,Int), (Int,Int))] = pgUtils2.loadFalseRdd(sc,curMonTime)

    LOGGER.info("pg old data {}",falsePlateRDD.count())

    var fakePlateList: List[(Int, String)] = null

    LOGGER.info("isFalseEnable {} and isFakeEnable {}",isFalseEnable,isFakeEnable)
    if (isFalseEnable) {
      LOGGER.info("do false")


      // 执行假牌分析，格式：RDD[(plateColor, plateNo)]
      fakePlateList = analysisFakePlateList(filterByPrefixRDD, vehicleRegisterRDD, threshold)

      // 从原始二级索引集合中过滤并获取相同车牌首条记录，格式：RDD[(plateColor, plateNo, VPR_RowKey)]
      val set = fakePlateList.toSet
      LOGGER.info("falseplate result size {}",set.size)
      val tempRdd: RDD[((Int, String,Int), (String,Long))] = tidIdxResultRDD.filter(res => {
        set.contains((1, res._2))
      }).sortBy(res => {
        // 按过车时间排序
        res._5
      }).map(res => {
        ((res._1, res._2,res._7), (res._4,res._5))
      })

      LOGGER.info("tempRdd.collect()")
      tempRdd.collect().foreach{println};

      val fakePlateDestRDD: RDD[((Int, String,Int),String)] = tempRdd.reduceByKey((a,b) => {
        ((a._1+a._2)+"|"+(b._1+b._2),0)
      }).map(res => ((res._1),res._2._1))

      LOGGER.info("fakePlateDestRDD.collect()")
      fakePlateDestRDD.collect().foreach{println};

      val pgUtils: PostgresUtils = PostgresUtils.getInstance()
      val  fakeRdd:RDD[((Int,String,Int,Int),String)] =  fakePlateDestRDD.map(res => ((res._1._1,res._1._2,0,res._1._3),res._2)).cache()//[(plateColor,plateNo,0,istaxi),rowkey]
      pgUtils.saveResultPgTable(fakeRdd,falsePlateRDD,curMonTime,0)